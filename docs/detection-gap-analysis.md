# Detection Gap Analysis â€“ PowerShell Abuse

## Scenario Description
A PowerShell command was executed on a Windows 11 endpoint using non-interactive and hidden execution parameters:
- NoProfile
- WindowStyle Hidden

The command performed local user enumeration.

## Expected Detection
Given the use of hidden PowerShell execution, an alert related to:
- Suspicious PowerShell usage
- Living-off-the-Land techniques
- Defense Evasion

was expected.

## Observed Result
No high-severity alert or specific PowerShell abuse detection was generated by Wazuh.
Only generic Windows logon and system policy alerts were observed.

## Impact
An attacker using PowerShell in this manner could perform reconnaissance without triggering meaningful alerts, increasing dwell time.

## Root Cause (Hypothesis)
- Sysmon rules may not sufficiently cover PowerShell command-line inspection.
- Wazuh ruleset may lack correlation for PowerShell evasion flags.
- PowerShell Script Block Logging is not enabled.

## Recommendation
- Enable PowerShell Script Block Logging on Windows endpoints.
- Create or tune Wazuh rules to alert on PowerShell execution with evasion-related flags.
- Map detection to MITRE ATT&CK T1059.001 (PowerShell).

## SOC Relevance
This gap highlights the importance of continuous detection tuning and validates the need for proactive threat hunting in SOC operations.
